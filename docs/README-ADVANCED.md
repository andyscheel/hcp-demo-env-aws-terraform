## Advanced

### Setup an Active Directory (optional)

See [./docs/README-AD.md](./docs/README-AD.md) for more information.

### Client IP changed?

Re-run to update the AWS network ACL and security groups

```
terraform apply -var-file=etc/bluedata_infra.tfvars \
   -var="client_cidr_block=$(curl -s http://ifconfig.me/ip)/32" 
```

### Add more workers?

Set the variable `worker_count=` in `etc/bluedata_infra.tfvars` to the desired number.

```
# don't forget to approve when prompted
terraform apply -var-file=etc/bluedata_infra.tfvars \
   -var="client_cidr_block=$(curl -s http://ifconfig.me/ip)/32" 

# update the json data
terraform output -json > generated/output.json

# run a script to prepare the worker - follow the prompts and instructions.
./scripts/bluedata_prepare_worker.sh
```

### Destroy environment when finished

```
# don't forget to approve when prompted
terraform destroy -var-file=etc/bluedata_infra.tfvars \
   -var="client_cidr_block=$(curl -s http://ifconfig.me/ip)/32" 
```

### Shutdown ec2 instances when not in use

Some scripts were generated by terraform for this:

- `./generated/cli_stop_ec2_instances.sh` to stop your instances
- `./generated/cli_start_ec2_instances.sh` to start your instances
- `./generated/cli_running_ec2_instances.sh` to view running instances

------
